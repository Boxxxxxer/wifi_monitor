# WiFi Monitor - React Native Application

## Описание проекта
WiFi Monitor - это кросс-платформенное мобильное приложение для Android и iOS, разработанное с нуля на React Native для мониторинга состояния Wi-Fi соединения. Приложение отслеживает подключение к сети Wi-Fi и уведомляет пользователя о восстановлении интернет-соединения с помощью звукового сигнала и всплывающего окна. Приложение работает в фоновом режиме, обеспечивая непрерывный мониторинг даже при выключенном экране.

## Функционал

- **Мониторинг в реальном времени**: Отображение текущего состояния Wi-Fi (подключено/отключено) на главном экране
- **Детальная информация**: Показ скорости соединения и уровня сигнала Wi-Fi
- **Фоновая служба**: Постоянный мониторинг Wi-Fi соединения с помощью фонового процесса
- **Звуковые уведомления**: При восстановлении интернет-соединения приложение воспроизводит звуковой сигнал
- **Всплывающее окно**: Автоматическая активация экрана и отображение модального окна с кнопкой "Stop Monitoring"
- **Автозапуск**: Возможность автоматического запуска мониторинга после перезагрузки устройства
- **Управление разрешениями**: Запрос необходимых разрешений для корректной работы
- **Многоязычность**: Поддержка русского и английского языков
- **Кросс-платформенность**: Поддержка Android и iOS

## Технический стек

- **Платформы**: Android, iOS
- **Framework**: React Native 0.73+
- **Язык**: TypeScript 5.x+
- **State Management**: Redux Toolkit / Zustand
- **Архитектура**: Feature-Sliced Design + Clean Architecture
- **Навигация**: React Navigation 6.x
- **UI Framework**: React Native Elements / NativeBase

## Системные требования

### Для разработки
- **Node.js**: 18.x или выше
- **npm/yarn**: Последняя стабильная версия
- **React Native CLI**: 2.0.1+
- **Android Studio**: Последняя стабильная версия (для Android)
- **Xcode**: 14.0+ (для iOS, только macOS)
- **JDK**: 17 или выше
- **Android SDK**: API Level 21+ (Android 5.0)
- **iOS**: iOS 11.0+

### Для обновления документации
Используй context7 mcp для обновления документаций и библиотек.

## Структура проекта
```
wifi_monitor/
├── .gemini/
│   ├── AppIcons/          # Иконки приложения
│   ├── Sounds/           # Звуковые файлы для уведомлений
│   ├── README.md         # Дополнительная документация
│   └── disign.json       # Конфигурация UI/UX дизайна
├── src/
│   ├── app/              # Конфигурация приложения
│   ├── shared/           # Общие компоненты и утилиты
│   ├── entities/         # Бизнес-сущности
│   ├── features/         # Функции приложения
│   ├── widgets/          # Составные UI блоки
│   ├── pages/            # Экраны приложения
│   └── processes/        # Бизнес-процессы
├── assets/
├── android/
├── ios/
├── index.js
└── package.json
```

## Обязательные зависимости (package.json)

```json
{
  "dependencies": {
    "react": "18.2.0",
    "react-native": "0.73.0",
    "@react-native-netinfo/netinfo": "^11.0.0",
    "react-native-wifi-reborn": "^4.12.0",
    "@react-native-async-storage/async-storage": "^1.19.0",
    "react-native-permissions": "^4.0.0",
    "react-native-background-service": "^1.0.0",
    "@react-navigation/native": "^6.1.0",
    "@react-navigation/stack": "^6.3.0",
    "react-native-sound": "^0.11.2",
    "react-native-push-notification": "^8.1.1",
    "@reduxjs/toolkit": "^2.0.0",
    "react-redux": "^9.0.0",
    "react-native-device-info": "^10.11.0",
    "react-native-background-timer": "^2.4.1",
    "react-native-modal": "^13.0.1",
    "react-native-vector-icons": "^10.0.0",
    "react-native-localization": "^2.3.0",
    "react-native-gesture-handler": "^2.14.0",
    "react-native-reanimated": "^3.6.0",
    "react-native-safe-area-context": "^4.8.0",
    "react-native-screens": "^3.29.0"
  },
  "devDependencies": {
    "@types/react": "^18.2.0",
    "@types/react-native": "^0.73.0",
    "typescript": "5.0.4",
    "@react-native/eslint-config": "^0.73.0",
    "@react-native/metro-config": "^0.73.0",
    "@react-native/typescript-config": "^0.73.0",
    "eslint": "^8.19.0",
    "jest": "^29.2.1",
    "prettier": "2.8.8"
  }
}
```

## Поэтапный план разработки

### Этап 1: Инициализация и настройка проекта
**Цель**: Создать базовую структуру проекта и настроить зависимости

**Задачи**:
- Инициализировать React Native проект с названием `wifi_monitor`
- Настроить TypeScript конфигурацию
- Установить и настроить все необходимые зависимости
- Создать структуру папок согласно Feature-Sliced Design
- Настроить `android/app/src/main/AndroidManifest.xml` с необходимыми разрешениями
- Настроить `ios/wifi_monitor/Info.plist` для iOS разрешений
- Импортировать ресурсы из `.gemini/` в папку `assets/`
- Настроить многоязычность (EN/RU) с `react-native-localization`
- Настроить React Navigation

**Тестирование**: Запуск приложения на эмуляторе Android и iOS

---

### Этап 2: Графический интерфейс (UI/UX)
**Цель**: Создать пользовательский интерфейс согласно design.json

**Задачи**:
- Создать систему тем на основе `disign.json` (dark theme, цветовая палитра)
- Настроить `react-native-vector-icons` и импортировать иконки
- Реализовать главный экран с:
  - Заголовком приложения
  - Карточкой состояния Wi-Fi (иконка + статус)
  - Отображением скорости соединения и уровня сигнала
  - Кнопкой "Start Monitor" (цвет по умолчанию из primary)
- Создать переиспользуемые UI компоненты:
  - Кастомные кнопки
  - Карточки информации
  - Переключатели
  - Модальные окна
- Реализовать адаптивный дизайн под разные размеры экранов
- Добавить анимации с `react-native-reanimated` согласно disign.json

**Особенности кнопки**:
- По умолчанию: цвет `#BB86FC` (primary)
- После нажатия "Start Monitor": цвет меняется на `#bf5911` и текст на "Stop Monitor"

**Тестирование**: Проверка отображения всех элементов UI на Android и iOS, смена тем, анимации

---

### Этап 3: Основная функция мониторинга сети
**Цель**: Реализовать логику отслеживания состояния Wi-Fi

**Задачи**:
- Создать сервис мониторинга сети с использованием `@react-native-netinfo/netinfo`
- Реализовать получение детальной информации о Wi-Fi с `react-native-wifi-reborn`:
  - SSID сети
  - Уровень сигнала (RSSI)
  - Скорость соединения
  - IP адрес
- Настроить State Management (Redux Toolkit/Zustand) для управления состоянием
- Реализовать периодическую проверку состояния сети (каждые 5 секунд)
- Добавить логику определения восстановления соединения после разрыва
- Создать типизированные интерфейсы для TypeScript

**Тестирование**: Включение/выключение Wi-Fi на Android и iOS, проверка обновления данных в реальном времени

---

### Этап 4: Привязка функционала кнопок и управление состоянием
**Цель**: Связать UI с бизнес-логикой

**Задачи**:
- Реализовать логику кнопки "Start/Stop Monitor":
  - Запуск/остановка мониторинга
  - Смена цвета кнопки с `#BB86FC` на `#bf5911`
  - Смена текста кнопки
- Настроить переключатель автозапуска с сохранением в AsyncStorage
- Реализовать смену языка с обновлением всего интерфейса
- Добавить валидацию состояний и обработку ошибок
- Реализовать сохранение/загрузку настроек пользователя
- Создать middleware для Redux для обработки асинхронных действий

**Тестирование**: Проверка работы всех кнопок на обеих платформах, сохранение настроек, смена языка

---

### Этап 5: Фоновая работа и уведомления
**Цель**: Обеспечить работу приложения в фоновом режиме

**Задачи**:
- Настроить `react-native-background-service` для фонового мониторинга
- Реализовать фоновую службу с:
  - Постоянным мониторингом состояния сети
  - Детекцией восстановления соединения
  - Логированием событий
- Настроить `react-native-push-notification` для системных уведомлений
- Интегрировать `react-native-sound` для воспроизведения звуковых сигналов
- Создать модальное окно с `react-native-modal` с кнопкой "Stop Monitor" при восстановлении сети
- Настроить специфичные для платформы конфигурации фоновой работы

**Поведение при срабатывании**:
- Воспроизведение звукового сигнала из `.gemini/Sounds/`
- Активация экрана устройства (Android) / показ уведомления (iOS)
- Отображение модального окна с кнопкой "Stop Monitor"
- Возможность отключения мониторинга из модального окна

**Тестирование**: Сворачивание приложения, отключение/включение Wi-Fi, проверка звука и уведомлений на обеих платформах

---

### Этап 6: Управление разрешениями
**Цель**: Настроить все необходимые разрешения для корректной работы

**Задачи**:
- Интегрировать `react-native-permissions` для запроса разрешений
- Реализовать проверку и запрос разрешений:
  - **Android**: `ACCESS_WIFI_STATE`, `ACCESS_NETWORK_STATE`, `WAKE_LOCK`, `POST_NOTIFICATIONS`, `REQUEST_IGNORE_BATTERY_OPTIMIZATIONS`, `RECEIVE_BOOT_COMPLETED`
  - **iOS**: Network access, Local notifications, Background app refresh
- Создать экраны объяснения необходимости разрешений
- Добавить обработку отказа от разрешений
- Реализовать автозапуск после перезагрузки устройства (Android)

**Тестирование**: Проверка запроса всех разрешений на разных версиях Android и iOS, работа без некоторых разрешений

---

### Этап 7: Автозапуск и оптимизация
**Цель**: Финальная настройка автозапуска и оптимизация производительности

**Задачи**:
- Настроить автозапуск приложения при загрузке Android:
  - `BOOT_COMPLETED` receiver
  - Автоматический запуск мониторинга (если включен в настройках)
- Оптимизировать потребление батареи:
  - Настройка интервалов проверки сети
  - Управление wake locks (Android)
  - Background app refresh оптимизация (iOS)
- Добавить логирование и отладочную информацию с `react-native-logs`
- Провести stress-тестирование на разных устройствах
- Настроить обработку deep links для возвращения в приложение

**Тестирование**: Перезагрузка устройства, длительная работа в фоне на обеих платформах, измерение потребления батареи

---

### Этап 8: Тестирование и сборка
**Цель**: Комплексное тестирование и подготовка релизных версий

**Задачи**:
- Написать unit-тесты для бизнес-логики с Jest
- Написать компонентные тесты для UI компонентов
- Провести integration тестирование на реальных устройствах
- Настроить сборку релизных версий:
  - **Android**: Настройка `android/app/build.gradle`, создание signing key для APK
  - **iOS**: Настройка Xcode project, certificates и provisioning profiles
  - Минификация и обфускация кода
- Собрать финальные билды (APK для Android, IPA для iOS)
- Провести финальное тестирование на реальных устройствах

**Команды для сборки**:

**Android APK**:
```bash
# Сборка релизного APK
cd android && ./gradlew assembleRelease

# Сборка bundle для Google Play
cd android && ./gradlew bundleRelease
```

**iOS IPA**:
```bash
# Сборка для iOS (требует macOS и Xcode)
npx react-native run-ios --configuration Release
```

**Тестирование**: Установка билдов на чистые устройства, проверка всего функционала на Android и iOS

---

## Конфигурация дизайна
Все настройки графического оформления находятся в файле `disign.json`:
- Цветовая схема (dark theme)
- Типографика (шрифты, размеры)
- Компоненты UI (кнопки, карточки, анимации)
- Общий стиль и настроение приложения

## Файловая структура ресурсов
```
.gemini/
├── AppIcons/           # Иконки приложения (launcher icon, notification icon)
├── Sounds/            # Звуковые файлы для уведомлений
├── README.md          # Дополнительная документация
└── disign.json        # Конфигурация UI/UX дизайна
```

## Важные особенности реализации

### Поведение кнопки мониторинга
- Исходное состояние: "Start Monitor" с цветом `#BB86FC`
- После запуска: "Stop Monitor" с цветом `#bf5911`
- Функционал: Запуск/остановка фонового мониторинга

### Поведение при восстановлении сети
- Воспроизведение звукового сигнала из `Sounds/`
- **Android**: Принудительная активация экрана устройства
- **iOS**: Показ push-уведомления
- Отображение модального окна с кнопкой "Stop Monitor"
- Возможность отключения мониторинга из модального окна

### Работа в фоновом режиме
- Непрерывный мониторинг даже при свернутом/закрытом приложении
- Минимальное потребление батареи
- Обход ограничений Android и iOS на фоновую работу

## Платформо-специфичные настройки

### Android Manifest (`android/app/src/main/AndroidManifest.xml`)
```xml
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.WAKE_LOCK" />
<uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
<uses-permission android:name="android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS" />
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
<uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
```

### iOS Info.plist (`ios/wifi_monitor/Info.plist`)
```xml
<key>NSLocationWhenInUseUsageDescription</key>
<string>This app needs location access to monitor WiFi networks</string>
<key>UIBackgroundModes</key>
<array>
    <string>background-processing</string>
    <string>background-fetch</string>
</array>
```

### Настройка иконки приложения
- Использовать иконки из `.gemini/AppIcons/`
- **Android**: Настроить адаптивные иконки, создать notification icon в monochrome стиле
- **iOS**: Создать иконки для всех размеров в Xcode

## Архитектурные принципы

### Feature-Sliced Design слои:
- **app/**: Конфигурация приложения, провайдеры, роутинг
- **pages/**: Экраны приложения
- **widgets/**: Составные UI блоки
- **features/**: Функции приложения (мониторинг, уведомления)
- **entities/**: Бизнес-сущности (WiFi, Network)
- **shared/**: Переиспользуемые компоненты и утилиты

### Управление состоянием:
- Использование Redux Toolkit для глобального состояния
- AsyncStorage для персистентного хранения настроек
- React hooks для локального состояния компонентов

## Критерии готовности

### Минимально жизнеспособный продукт (MVP):
- ✅ Отображение статуса Wi-Fi в реальном времени
- ✅ Кнопка запуска/остановки мониторинга
- ✅ Фоновая работа с уведомлениями
- ✅ Звуковой сигнал при восстановлении сети
- ✅ Сборка работающих APK и IPA файлов

### Полнофункциональная версия:
- ✅ Все функции MVP
- ✅ Автозапуск после перезагрузки (Android)
- ✅ Модальное окно при срабатывании
- ✅ Многоязычность (EN/RU)
- ✅ Настройки и их сохранение
- ✅ Оптимизация батареи на обеих платформах
- ✅ Полная поддержка iOS и Android

## Этапы разработки с паузами для тестирования
❗ **ВАЖНО**: После завершения каждого этапа необходимо выходить из режима написания кода для проведения тестирования. Только после успешного тестирования этапа можно переходить к следующему.

### Контрольные точки тестирования:
1. **После Этапа 1**: Проверка сборки проекта и запуска на Android и iOS
2. **После Этапа 2**: Тестирование UI, анимаций, смены тем на обеих платформах
3. **После Этапа 3**: Проверка мониторинга сети в foreground режиме
4. **После Этапа 4**: Тестирование всех кнопок и сохранения настроек
5. **После Этапа 5**: Проверка фоновой работы и уведомлений на Android и iOS
6. **После Этапа 6**: Тестирование разрешений на разных версиях Android и iOS
7. **После Этапа 7**: Проверка автозапуска и оптимизации на обеих платформах
8. **После Этапа 8**: Финальное тестирование APK и IPA файлов

## Требования к релизным сборкам

### Android APK
**Предварительная настройка**:
1. Настройка signing key:
```bash
keytool -genkey -v -keystore ~/wifi-monitor-key.keystore -keyalg RSA -keysize 2048 -validity 10000 -alias wifi-monitor-key
```

2. Создание `android/gradle.properties`:
```
MYAPP_UPLOAD_STORE_FILE=wifi-monitor-key.keystore
MYAPP_UPLOAD_KEY_ALIAS=wifi-monitor-key
MYAPP_UPLOAD_STORE_PASSWORD=****
MYAPP_UPLOAD_KEY_PASSWORD=****
```

### iOS IPA
**Предварительная настройка**:
1. Настройка Apple Developer аккаунта
2. Создание certificates и provisioning profiles в Xcode
3. Настройка Bundle Identifier
4. Конфигурация для App Store или Ad Hoc distribution

**Сборка релизных версий**:
```bash
# Очистка проекта
npx react-native start --reset-cache

# Android
cd android && ./gradlew clean
cd android && ./gradlew assembleRelease

# iOS (только на macOS)
npx react-native run-ios --configuration Release
```

**Тестирование билдов**:
- Установка на устройства без React Native окружения
- Проверка работы всех функций
- Тестирование автозапуска после перезагрузки
- Проверка работы в фоновом режиме на обеих платформах
- Проверка производительности и потребления батареи